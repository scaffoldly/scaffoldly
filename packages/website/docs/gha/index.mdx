---
sidebar_position: 4
---

# GitHub Action Reference

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
```

Scaffoldly provides a seamless integration with GitHub Actions, allowing you to deploy your applications using GitHub. This guide will walk you through the process of setting up GitHub Actions for your Scaffoldly projects.

Scaffoldly is available on the [GitHub Actions Marketplace](https://github.com/marketplace/actions/scaffoldly).

## Usage

To use Scaffoldly in your GitHub Actions workflow, you need to create a workflow file in your repository. Follow these steps:

<Tabs groupId="aws-access">
  <TabItem value="role-assumption" label="AWS IAM Role (Recommended)">
    1. Create a new [IAM role](/docs/cloud/aws#iam-role) in AWS with the necessary permissions for your deployment.

    :::tip

    Run `npx scaffoldly show permissions` to see the necessary permissions.

    See [GitHub Authentication to AWS](https://docs.github.com/en/actions/security-for-github-actions/security-hardening-your-deployments/configuring-openid-connect-in-amazon-web-services) for more information on configuring IAM roles.

    :::

    1. Create new [Repository Variable](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/store-information-in-variables) in your GitHub repository named `AWS_ROLE_ARN` for the desired IAM Role.

    1. Add the following YAML configuration to your `.github/workflows/scaffoldly.yml` file:
      ```yaml title=".github/workflows/scaffoldly.yml"
      name: Scaffoldly

      on:
        workflow_dispatch:
        push:

      permissions:
        id-token: write
        contents: read

      env:
        # AWS_REGION: us-east-1 # Optional, defaults to us-east-1
        AWS_ROLE_ARN: ${{ vars.AWS_ROLE_ARN }}

      jobs:
        deploy:
          runs-on: ubuntu-latest
          steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Deploy
              uses: scaffoldly/scaffoldly@v1
              with:
                secrets: ${{ toJSON(secrets) }}
      ```

  </TabItem>
  <TabItem value="access-keys" label="AWS Access Keys">
    1. Create a new [IAM user](/docs/cloud/aws#access-keys) in AWS with the necessary permissions for your deployment.
        
    :::tip

    Run `npx scaffoldly show permissions` to see the necessary permissions.

    :::

    1. Create new [Repository Secrets](https://docs.github.com/en/actions/security-for-github-actions/security-guides/using-secrets-in-github-actions) in your GitHub repository named `AWS_ACCESS_KEY_ID` and
    `AWS_SECRET_ACCESS_KEY` for the desired IAM User.

    1. Add the following YAML configuration to your `.github/workflows/scaffoldly.yml` file:
      ```yaml title=".github/workflows/scaffoldly.yml"
      name: Scaffoldly

      on:
        workflow_dispatch:
        push:

      permissions:
        id-token: write
        contents: read

      env:
        # AWS_REGION: us-east-1 # Optional, defaults to us-east-1
        AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}

      jobs:
        deploy:
          runs-on: ubuntu-latest
          steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Deploy
              uses: scaffoldly/scaffoldly@v1
              with:
                secrets: ${{ toJSON(secrets) }}
      ```

  </TabItem>
</Tabs>

## Inputs

### `operation`

_**Default**_: `deploy`

The operation to perform. Supported options:

- `deploy`: Deploy the application application, this is equivalent to `npx scaffoldly deploy`.

### `github-token`

_**Default**_: `${{ github.token}}`

The GitHub token to use for authentication. This token is automatically generated by GitHub Actions. Omit this input if the default repository token and its associated [`permissions`](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/controlling-permissions-for-github_token) is sufficient.

This token could potentially be used for:

- Authentication to AWS services (if using IAM roles).

See:

- [AWS Authentication Methods](/docs/cloud/aws#authentication-methods)

### `working-directory`

_**Default**_: `.`

The directory where the application code is located. Useful if your application is in a subdirectory. Omit this input if your application is in the root of the repository.

### `secrets`

_**Recommended**_: `${{ toJSON(secrets) }}`

_**Default**_: `{}`

A JSON string of secrets that can be uploaded into Cloud Secrets.

_**See**_:

- [Secrets](/docs/config/secrets)

## Outputs

### `url`

The URL of the deployed application. This output can be used in subsequent steps of your workflow.
